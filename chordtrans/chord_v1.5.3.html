<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’Œå¼¦ç¿»è­¯æ©Ÿ - ç¾åŒ–å‡ç´šç‰ˆ v1.5.3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', 'Segoe UI', sans-serif;
            background: linear-gradient(120deg, #f8fafc 0%, #e0e7ff 100%);
        }
        #menu-toggle { display: none; }
        #menu-toggle:checked ~ #menu-sidebar { transform: translateX(0);}
        .focus-ring:focus {
            --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
            box-shadow: var(--tw-ring-shadow);
        }
        #menu-sidebar { backdrop-filter: blur(6px); border-right: 1px solid #e0e7ef;}
        .menu-btn {
            transition: box-shadow 0.2s;
            box-shadow: 0 1px 8px 0 rgb(72 99 255 / 8%);
        }
        .menu-btn:hover {
            box-shadow: 0 4px 12px 0 rgb(72 99 255 / 12%);
            background: linear-gradient(90deg, #f1f5ff 0%, #dbeafe 100%);
        }
        /* Modal å„ªåŒ– */
        #modal {
            /* è®“modalæœ¬èº«è¶³å¤ å¤§ä¸”éŸ¿æ‡‰å¼ */
            display: none;
        }
        #modal.flex {
            display: flex;
        }
        .modal-content {
            font-size: 1rem;
            position: relative;
            width: 100%;
            max-width: 900px;
            min-width: 350px;
            background: #fff;
            border-radius: 1.2rem;
            box-shadow: 0 10px 32px 0 rgb(72 99 255 / 15%);
            padding: 2.5rem;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-content h3 { font-size: 1.15em; color: #6366f1; font-weight: 700; margin-top: 1.4em; margin-bottom: 0.6em;}
        .modal-content table { font-size: 0.95em; }
        .modal-content th, .modal-content td { padding: 0.3em 0.5em; }
        .modal-content mark { background: #eef2ff; color: #4338ca; padding: 0.1em 0.3em; border-radius: 3px;}
        /* Modal é—œé–‰å‰å‰å¤–éƒ¨ */
        #modal-close-outer {
            position: absolute;
            top: 1.5rem;
            left: 50%;
            transform: translateX(410px); /* modal-contentå¯¬åº¦ä¸€åŠ+é–“è· */
            z-index: 50;
            font-size: 2.1rem;
            background: rgba(255,255,255,0.9);
            color: #6366f1;
            border-radius: 50%;
            padding: 0.25em 0.53em;
            box-shadow: 0 2px 8px 0 rgb(72 99 255 / 12%);
            border: 1px solid #dbeafe;
            cursor: pointer;
            transition: color 0.2s, background 0.2s;
        }
        @media (max-width: 950px) {
            #modal-close-outer {
                transform: translateX(375px);
            }
            .modal-content { max-width: 98vw; }
        }
        @media (max-width: 600px) {
            #modal-close-outer {
                left: auto;
                right: 2rem;
                top: 1rem;
                transform: none;
            }
            .modal-content { max-width: 99vw; min-width: 0; padding: 1.2rem;}
        }
        #modal-close-outer:hover { color: #ef4444; background: #e0e7ff; }
        .nice-scroll::-webkit-scrollbar { height: 8px; background: #e0e7ff;}
        .nice-scroll::-webkit-scrollbar-thumb { background: #b4c7ff; border-radius: 6px;}
    </style>
</head>
<body class="p-0 sm:p-8">

<input type="checkbox" id="menu-toggle" class="hidden">
<div id="menu-sidebar" class="fixed top-0 left-0 w-72 h-full bg-white/95 shadow-2xl z-30 transform -translate-x-full transition-transform duration-300 ease-in-out p-7 flex flex-col gap-6 border-r border-indigo-100">
    <label for="menu-toggle" class="absolute top-5 right-5 text-3xl cursor-pointer text-gray-400 hover:text-red-500 transition-colors">&times;</label>
    <h2 class="text-2xl font-bold text-indigo-700 border-b pb-3 mb-3 tracking-wide flex gap-2 items-center">
        <span class="text-indigo-400">ğŸ¹</span> å’Œå¼¦å·¥å…·ç®±
    </h2>
    <button class="menu-btn w-full py-3 px-4 rounded-xl text-gray-700 hover:bg-indigo-50 text-lg font-medium flex items-center gap-2 transition" onclick="showModal('manual')">
        <span>ğŸ“–</span> èªªæ˜æ›¸
    </button>
    <button class="menu-btn w-full py-3 px-4 rounded-xl text-gray-700 hover:bg-indigo-50 text-lg font-medium flex items-center gap-2 transition" onclick="showModal('basicInterval')">
        <span>ğŸ¼</span> åŸºç¤éŸ³ç¨‹åç¨±èˆ‡é–“è·å°ç…§è¡¨
    </button>
    <button class="menu-btn w-full py-3 px-4 rounded-xl text-gray-700 hover:bg-indigo-50 text-lg font-medium flex items-center gap-2 transition" onclick="showModal('intervalTable')">
        <span>ğŸ—ºï¸</span> å…¨éŸ³åŸŸéŸ³ç¨‹å°ç…§è¡¨ (12å€‹åŠéŸ³)
    </button>
    <button class="menu-btn w-full py-3 px-4 rounded-xl text-gray-700 hover:bg-indigo-50 text-lg font-medium flex items-center gap-2 transition" onclick="showModal('majorScale')">
        <span>ğŸŒ</span> é—œæ–¼è‡ªç„¶å¤§èª¿éŸ³éš
    </button>
    <button class="menu-btn w-full py-3 px-4 rounded-xl text-gray-700 hover:bg-indigo-50 text-lg font-medium flex items-center gap-2 transition" onclick="showModal('minorScale')">
        <span>ğŸŒš</span> é—œæ–¼è‡ªç„¶å°èª¿éŸ³éš
    </button>
    <button class="menu-btn w-full py-3 px-4 rounded-xl text-gray-700 hover:bg-indigo-50 text-lg font-medium flex items-center gap-2 transition" onclick="showModal('other')">
        <span>ğŸ“¦</span> å…¶ä»–
    </button>
</div>

<div class="relative max-w-xl mx-auto bg-white/95 p-6 sm:p-8 rounded-none sm:rounded-2xl shadow-none sm:shadow-2xl border-none sm:border border-indigo-100 min-h-screen sm:min-h-0">
    <label for="menu-toggle" class="absolute top-5 left-5 text-3xl cursor-pointer text-indigo-400 hover:text-indigo-600 transition-colors sm:top-8 sm:left-8 z-20">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </label>
    <h1 class="text-4xl font-extrabold text-center text-indigo-700 mt-2 sm:mt-0 pt-12 sm:pt-2 tracking-wide drop-shadow mb-1">ğŸµ å’Œå¼¦ç¿»è­¯æ©Ÿ</h1>
    <p class="text-center text-gray-500 mb-6 text-base">æ”¯æ´å¸¸è¦‹ä¸‰å’Œå¼¦åˆ°åä¸‰å’Œå¼¦ã€‚<span class="text-indigo-400 font-semibold text-xs ml-2">v1.5.3</span></p>
    <div class="flex flex-col sm:flex-row gap-3 mb-6">
        <input type="text" id="chordInput" placeholder="è¼¸å…¥å’Œå¼¦åç¨±ï¼Œå¦‚ï¼šC13, F#m11, Ebm7b5" 
               class="flex-grow p-3 border border-indigo-200 rounded-xl text-lg focus-ring focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 transition shadow-sm" 
               onkeyup="if(event.key === 'Enter') translateChord()">
        <button onclick="translateChord()" 
                class="w-full sm:w-auto px-7 py-3 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white font-semibold rounded-xl shadow-lg hover:from-indigo-600 hover:to-indigo-700 transition transform hover:scale-[1.04]">
            è§£ æ
        </button>
    </div>
    <div id="result" class="mt-8 p-5 bg-white border border-indigo-100 rounded-xl text-gray-800 shadow-md transition duration-300">
        <p class="text-center text-lg text-gray-500">è¼¸å…¥å’Œå¼¦åç¨±å¾Œï¼Œçµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡ã€‚</p>
    </div>
</div>

<!-- Modal -->
<div id="modal" class="fixed inset-0 bg-gray-900 bg-opacity-70 hidden items-center justify-center p-4 z-40" onclick="closeModal(event)">
    <!-- å¤–éƒ¨å‰å‰ -->
    <span id="modal-close-outer" onclick="closeModal(event)" title="é—œé–‰">&#10005;</span>
    <div class="modal-content nice-scroll" onclick="event.stopPropagation()">
        <div id="modal-body"></div>
    </div>
</div>

<script>
    // å…§å®¹è³‡æ–™
    const modalContent = {
        manual: `
        <h2 class="text-2xl font-bold text-indigo-700 mb-5 border-b pb-3 flex gap-2 items-center">
            <span>ğŸ“–</span> ä½¿ç”¨èªªæ˜æ›¸
        </h2>
        <div class="text-gray-700 space-y-4 text-base leading-relaxed">
            <p><strong>æ­¡è¿ä½¿ç”¨å’Œå¼¦ç¿»è­¯æ©Ÿï¼</strong> é€™å€‹å·¥å…·èƒ½å¹«æ‚¨å¿«é€ŸæŸ¥è©¢å„ç¨®å’Œå¼¦çš„çµ„æˆéŸ³åŠæ¨‚ç†å®šç¾©ï¼Œç„¡è«–æ˜¯åˆå­¸è€…æˆ–é€²éšç©å®¶éƒ½é©ç”¨ã€‚</p>
            <h3>å¦‚ä½•è¼¸å…¥å’Œå¼¦ï¼Ÿ</h3>
            <p>è«‹ä¾å¾ªã€Œ<mark>æ ¹éŸ³ + å’Œå¼¦å“è³ª</mark>ã€çš„æ ¼å¼è¼¸å…¥ï¼š</p>
            <ul class="list-disc list-inside ml-4 space-y-1">
                <li><b>æ ¹éŸ³:</b> ä½¿ç”¨æ¨™æº–å­—æ¯ <span class="font-mono text-indigo-600">A</span> åˆ° <span class="font-mono text-indigo-600">G</span>ï¼Œå‡è¨˜è™Ÿç”¨ <span class="font-mono text-indigo-600">#</span> (å¦‚ <span class="font-mono">F#</span>)ï¼Œé™è¨˜è™Ÿç”¨ <span class="font-mono text-indigo-600">b</span> (å¦‚ <span class="font-mono">Eb</span>)ã€‚</li>
                <li><b>å“è³ª:</b> ä¾‹å¦‚ï¼š<span class="font-mono">m</span> (å°èª¿), <span class="font-mono">maj7</span>, <span class="font-mono">m7</span>, <span class="font-mono">dim</span>, <span class="font-mono">aug</span>, <span class="font-mono">sus4</span>, <span class="font-mono">add9</span> ç­‰ã€‚</li>
            </ul>
            <h3>æ”¯æ´çš„é¡å‹ç¯„ä¾‹ï¼š</h3>
            <table class="min-w-full divide-y divide-gray-200 border border-indigo-100 rounded-lg shadow-sm text-sm">
                <thead class="bg-indigo-50">
                    <tr>
                        <th>é¡å‹</th>
                        <th>ç¯„ä¾‹</th>
                        <th>éŸ³ç¨‹æ•¸</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-indigo-50">
                    <tr><td>ä¸‰å’Œå¼¦</td><td>C, F#m, Cdim, Gaug</td><td>3</td></tr>
                    <tr><td>ä¸ƒå’Œå¼¦</td><td>A7, Bbmaj7, Dm7b5, Edim7</td><td>4</td></tr>
                    <tr><td>å»¶ä¼¸å’Œå¼¦</td><td>C9, Gm11, Emaj13</td><td>5-7</td></tr>
                    <tr><td>è®ŠåŒ–å’Œå¼¦</td><td>D7b9, C#11, Fmaj#11</td><td>4-6</td></tr>
                    <tr><td>æ›ç•™/åŠ éŸ³</td><td>Csus4, Asus2, Gadd9</td><td>3-4</td></tr>
                </tbody>
            </table>
        </div>
        <div class="mt-6 text-xs text-gray-400 text-right border-t pt-3">
            2025-10-12 08:53:48 v1.5.3
        </div>
        `,
        basicInterval: `
        <h2 class="text-2xl font-bold text-indigo-700 mb-5 border-b pb-3 flex gap-2 items-center">
            <span>ğŸ¼</span> åŸºç¤éŸ³ç¨‹åç¨±èˆ‡é–“è·å°ç…§è¡¨
        </h2>
        <div>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
        <tr>
            <th>éŸ³ç¨‹åç¨±</th><th>å°æ‡‰çš„éŸ³ç¨‹ç´šæ•¸</th><th>é–“è·ï¼ˆåŠéŸ³æ•¸é‡ï¼‰</th><th>èˆ‰ä¾‹ (å¾ C é–‹å§‹)</th>
        </tr>
        </thead>
        <tbody>
        <tr><td>ç´”ä¸€åº¦ (Perfect Unison)</td><td>1 åº¦</td><td>0</td><td>C åˆ° C</td></tr>
        <tr><td>å¢ä¸€åº¦/å°äºŒåº¦</td><td>1 åº¦ / 2 åº¦</td><td>1</td><td>C åˆ° C# / C åˆ° Dâ™­</td></tr>
        <tr><td>å¤§äºŒåº¦ (Major Second)</td><td>2 åº¦</td><td>2</td><td>C åˆ° D</td></tr>
        <tr><td>å°ä¸‰åº¦ (Minor Third)</td><td>3 åº¦</td><td>3</td><td>C åˆ° Eâ™­</td></tr>
        <tr><td>å¤§ä¸‰åº¦ (Major Third)</td><td>3 åº¦</td><td>4</td><td>C åˆ° E</td></tr>
        <tr><td>ç´”å››åº¦ (Perfect Fourth)</td><td>4 åº¦</td><td>5</td><td>C åˆ° F</td></tr>
        <tr><td>å¢å››åº¦/æ¸›äº”åº¦</td><td>4 åº¦ / 5 åº¦</td><td>6</td><td>C åˆ° F# / C åˆ° Gâ™­</td></tr>
        <tr><td>ç´”äº”åº¦ (Perfect Fifth)</td><td>5 åº¦</td><td>7</td><td>C åˆ° G</td></tr>
        <tr><td>å¢äº”åº¦/å°å…­åº¦</td><td>5 åº¦ / 6 åº¦</td><td>8</td><td>C åˆ° G# / C åˆ° Aâ™­</td></tr>
        <tr><td>å¤§å…­åº¦ (Major Sixth)</td><td>6 åº¦</td><td>9</td><td>C åˆ° A</td></tr>
        <tr><td>å°ä¸ƒåº¦ (Minor Seventh)</td><td>7 åº¦</td><td>10</td><td>C åˆ° Bâ™­</td></tr>
        <tr><td>å¤§ä¸ƒåº¦ (Major Seventh)</td><td>7 åº¦</td><td>11</td><td>C åˆ° B</td></tr>
        <tr><td>ç´”å…«åº¦ (Perfect Octave)</td><td>8 åº¦</td><td>12</td><td>C åˆ° C (é«˜å…«åº¦)</td></tr>
        </tbody>
        </table>
        </div>
        `,
        intervalTable: `
        <h2 class="text-2xl font-bold text-indigo-700 mb-5 border-b pb-3 flex gap-2 items-center">
            <span>ğŸ—ºï¸</span> å…¨éŸ³åŸŸéŸ³ç¨‹å°ç…§è¡¨ (12å€‹åŠéŸ³)
        </h2>
        <div>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
            <tr>
            <th>æ ¹éŸ³ (Root)</th><th>P1 (0)</th><th>m2 (1)</th><th>M2 (2)</th><th>m3 (3)</th><th>M3 (4)</th><th>P4 (5)</th><th>A4/d5 (6)</th><th>P5 (7)</th><th>A5/m6 (8)</th><th>M6 (9)</th><th>m7 (10)</th><th>M7 (11)</th><th>P8 (12)</th>
            </tr>
        </thead>
        <tbody>
<tr><td>C</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td></tr>
<tr><td>C#/Dâ™­</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td></tr>
<tr><td>D</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td></tr>
<tr><td>D#/Eâ™­</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td></tr>
<tr><td>E</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td></tr>
<tr><td>F</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td></tr>
<tr><td>F#/Gâ™­</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td></tr>
<tr><td>G</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td></tr>
<tr><td>G#/Aâ™­</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td></tr>
<tr><td>A</td><td>A</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td></tr>
<tr><td>A#/Bâ™­</td><td>A#/Bâ™­</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td></tr>
<tr><td>B</td><td>B</td><td>C</td><td>C#/Dâ™­</td><td>D</td><td>D#/Eâ™­</td><td>E</td><td>F</td><td>F#/Gâ™­</td><td>G</td><td>G#/Aâ™­</td><td>A</td><td>A#/Bâ™­</td><td>B</td></tr>
        </tbody>
        </table>
        </div>
        `,
        majorScale: `
        <h2 class="text-2xl font-bold text-indigo-700 mb-5 border-b pb-3 flex gap-2 items-center">
            <span>ğŸŒ</span> é—œæ–¼è‡ªç„¶å¤§èª¿éŸ³éš
        </h2>
        <div>
        <h3>æ§‹é€ èˆ‡éŸ³ç¨‹å°ç…§è¡¨</h3>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
        <tr><th>éŸ³éšç´šæ•¸</th><th>éŸ³ç¨‹åç¨±</th><th>åŠéŸ³æ•¸ï¼ˆé–“è·ï¼‰</th><th>C å¤§èª¿ç¯„ä¾‹éŸ³</th><th>éŸ³éšè§’è‰²</th></tr>
        </thead>
        <tbody>
        <tr><td>I (Root)</td><td>ç´”ä¸€åº¦ (P1)</td><td>0</td><td>C</td><td>ä¸»éŸ³ (Tonic)</td></tr>
        <tr><td>II</td><td>å¤§äºŒåº¦ (M2)</td><td>2</td><td>D</td><td>ä¸Šä¸»éŸ³ (Supertonic)</td></tr>
        <tr><td>III</td><td>å¤§ä¸‰åº¦ (M3)</td><td>4</td><td>E</td><td>ä¸­éŸ³ (Mediant)</td></tr>
        <tr><td>IV</td><td>ç´”å››åº¦ (P4)</td><td>5</td><td>F</td><td>ä¸‹å±¬éŸ³ (Subdominant)</td></tr>
        <tr><td>V</td><td>ç´”äº”åº¦ (P5)</td><td>7</td><td>G</td><td>å±¬éŸ³ (Dominant)</td></tr>
        <tr><td>VI</td><td>å¤§å…­åº¦ (M6)</td><td>9</td><td>A</td><td>ä¸‹ä¸­éŸ³ (Submediant)</td></tr>
        <tr><td>VII</td><td>å¤§ä¸ƒåº¦ (M7)</td><td>11</td><td>B</td><td>å°éŸ³ (Leading Tone)</td></tr>
        <tr><td>VIII (I)</td><td>ç´”å…«åº¦ (P8)</td><td>12</td><td>C</td><td>å…«åº¦ (Octave)</td></tr>
        </tbody>
        </table>

        <h3>åŸºç¤ä¸‰å’Œå¼¦é¡å‹èˆ‡åŠŸèƒ½è¡¨</h3>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
        <tr><th>å’Œå¼¦ç´šæ•¸</th><th>å’Œå¼¦æ€§è³ª</th><th>å’Œå¼¦ç¯„ä¾‹ (C å¤§èª¿)</th><th>ä¸»è¦åŠŸèƒ½</th><th>è½è¦ºæ„Ÿå—èˆ‡æƒ…ç·’</th></tr>
        </thead>
        <tbody>
        <tr><td>I</td><td>Major (å¤§ä¸‰)</td><td>C</td><td>ä¸»åŠŸèƒ½ (Tonic)</td><td>ç©©å®šã€çµ‚é»ã€æ˜äº®ã€å¿«æ¨‚ã€‚</td></tr>
        <tr><td>ii</td><td>minor (å°ä¸‰)</td><td>Dm</td><td>ä¸‹å±¬åŠŸèƒ½ (Subdominant)</td><td>æŸ”å’Œã€å…§æ–‚ã€ç‚º V ç´šåšæº–å‚™ã€‚</td></tr>
        <tr><td>iii</td><td>minor (å°ä¸‰)</td><td>Em</td><td>ä¸»/å±¬åŠŸèƒ½ (æ¬¡è¦)</td><td>å…§çœã€æƒ…ç·’è¼ƒç‚ºå¹³å’Œã€‚</td></tr>
        <tr><td>IV</td><td>Major (å¤§ä¸‰)</td><td>F</td><td>ä¸‹å±¬åŠŸèƒ½ (Subdominant)</td><td>å¯¬å»£ã€ç©©å®šï¼Œæ˜¯ I ç´šå’Œå¼¦çš„æœ€ä½³æ›¿ä»£ã€‚</td></tr>
        <tr><td>V</td><td>Major (å¤§ä¸‰)</td><td>G</td><td>å±¬åŠŸèƒ½ (Dominant)</td><td>æ¥µå…·å¼µåŠ›ï¼Œè¦æ±‚è¢«è§£æ±ºï¼ˆå°å‘ I ç´šï¼‰ã€‚</td></tr>
        <tr><td>vi</td><td>minor (å°ä¸‰)</td><td>Am</td><td>ä¸»åŠŸèƒ½ (Tonic) (æ›¿ä»£)</td><td>æ†‚é¬±ã€å“€å‚·ï¼Œæ˜¯ I ç´šçš„åŒèª¿å°èª¿ï¼Œå¸¸ç”¨æ–¼å‰¯æ­Œè½‰æŠ˜ã€‚</td></tr>
        <tr><td>viiÂ°</td><td>diminished (æ¸›ä¸‰)</td><td>Bdim</td><td>å±¬åŠŸèƒ½ (Dominant) (å°éŸ³)</td><td>æ¥µä¸å’Œè«§ï¼Œæœ€å¼·çƒˆçš„å°å‘æ€§ï¼Œå¿…é ˆè§£æ±ºå› I ç´šã€‚</td></tr>
        </tbody>
        </table>
        <div class="mb-3"><b>ç¸½çµå…¬å¼ï¼š</b> <span class="font-mono text-indigo-600">Major - minor - minor - Major - Major - minor - diminished</span></div>
        </div>
        `,
        minorScale: `
        <h2 class="text-2xl font-bold text-indigo-700 mb-5 border-b pb-3 flex gap-2 items-center">
            <span>ğŸŒš</span> é—œæ–¼è‡ªç„¶å°èª¿éŸ³éš
        </h2>
        <div>
        <h3>æ§‹é€ èˆ‡éŸ³ç¨‹å°ç…§è¡¨</h3>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
        <tr><th>éŸ³éšç´šæ•¸</th><th>éŸ³ç¨‹åç¨±</th><th>åŠéŸ³æ•¸ï¼ˆé–“è·ï¼‰</th><th>A è‡ªç„¶å°èª¿ç¯„ä¾‹éŸ³</th><th>éŸ³éšè§’è‰²</th></tr>
        </thead>
        <tbody>
        <tr><td>i (Root)</td><td>ç´”ä¸€åº¦ (P1)</td><td>0</td><td>A</td><td>ä¸»éŸ³ (Tonic)</td></tr>
        <tr><td>ii</td><td>å¤§äºŒåº¦ (M2)</td><td>2</td><td>B</td><td>ä¸Šä¸»éŸ³ (Supertonic)</td></tr>
        <tr><td>iii</td><td>å°ä¸‰åº¦ (m3)</td><td>3</td><td>C</td><td>ä¸­éŸ³ (Mediant)</td></tr>
        <tr><td>iv</td><td>ç´”å››åº¦ (P4)</td><td>5</td><td>D</td><td>ä¸‹å±¬éŸ³ (Subdominant)</td></tr>
        <tr><td>v</td><td>ç´”äº”åº¦ (P5)</td><td>7</td><td>E</td><td>å±¬éŸ³ (Dominant)</td></tr>
        <tr><td>vi</td><td>å°å…­åº¦ (m6)</td><td>8</td><td>F</td><td>ä¸‹ä¸­éŸ³ (Submediant)</td></tr>
        <tr><td>vii</td><td>å°ä¸ƒåº¦ (m7)</td><td>10</td><td>G</td><td>æ¬¡å±¬éŸ³ (Subtonic)</td></tr>
        <tr><td>viii (i)</td><td>ç´”å…«åº¦ (P8)</td><td>12</td><td>A</td><td>å…«åº¦ (Octave)</td></tr>
        </tbody>
        </table>

        <h3>åŸºç¤ä¸‰å’Œå¼¦é¡å‹èˆ‡åŠŸèƒ½è¡¨</h3>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
        <tr><th>å’Œå¼¦ç´šæ•¸</th><th>å’Œå¼¦æ€§è³ª</th><th>å’Œå¼¦ç¯„ä¾‹ (A å°èª¿)</th><th>ä¸»è¦åŠŸèƒ½</th><th>è½è¦ºæ„Ÿå—èˆ‡æƒ…ç·’</th></tr>
        </thead>
        <tbody>
        <tr><td>i</td><td>minor (å°ä¸‰)</td><td>Am</td><td>ä¸»åŠŸèƒ½ (Tonic)</td><td>ç©©å®šã€æ†‚é¬±ã€å…§çœã€‚å°èª¿çš„ã€Œå®¶ã€ã€‚</td></tr>
        <tr><td>iiÂ°</td><td>diminished (æ¸›ä¸‰)</td><td>Bdim</td><td>ä¸‹å±¬åŠŸèƒ½</td><td>ä¸ç©©å®šï¼Œé€šå¸¸ç”¨ä¾†å°å‘ v æˆ– iã€‚</td></tr>
        <tr><td>III</td><td>Major (å¤§ä¸‰)</td><td>C</td><td>ä¸»åŠŸèƒ½ (é—œä¿‚å¤§èª¿)</td><td>é—œä¿‚å¤§èª¿ï¼Œè²éŸ³æ˜äº®ï¼Œæ˜¯ i ç´šçš„å¸¸ç”¨æ›¿ä»£ã€‚</td></tr>
        <tr><td>iv</td><td>minor (å°ä¸‰)</td><td>Dm</td><td>ä¸‹å±¬åŠŸèƒ½</td><td>æŸ”å’Œçš„æ¨é€²ï¼Œæ˜¯å°èª¿ä¸­æœ€å¸¸ç”¨çš„ä¸‹å±¬å’Œå¼¦ã€‚</td></tr>
        <tr><td>v</td><td>minor (å°ä¸‰)</td><td>Em</td><td>å±¬åŠŸèƒ½ (æŸ”å’Œ)</td><td>å…·æœ‰æº«å’Œçš„å¼µåŠ›ï¼Œä½†ç¼ºä¹å¤§èª¿ V ç´šçš„å¼·çƒˆè§£æ±ºæ„Ÿã€‚</td></tr>
        <tr><td>VI</td><td>Major (å¤§ä¸‰)</td><td>F</td><td>ä¸‹å±¬åŠŸèƒ½ (æ¬¡è¦)</td><td>é£½æ»¿ã€å¯Œæœ‰æˆ²åŠ‡æ€§ï¼Œå¸¸ç”¨æ–¼æƒ…ç·’çš„çˆ†ç™¼ã€‚</td></tr>
        <tr><td>VII</td><td>Major (å¤§ä¸‰)</td><td>G</td><td>æ¬¡å±¬åŠŸèƒ½ (Subtonic)</td><td>æŸ”å’Œã€é †æš¢ï¼Œå¸¸ç”¨æ–¼æµè¡Œæ¨‚ï¼Œä½¿å’Œè²æµå‹•ã€‚</td></tr>
        </tbody>
        </table>
        <div class="mb-3"><b>ç¸½çµå…¬å¼ï¼š</b> <span class="font-mono text-indigo-600">minor - diminished - Major - minor - minor - Major - Major</span></div>
        </div>
        `,
        other: `
        <h2 class="text-2xl font-bold text-indigo-700 mb-5 border-b pb-3 flex gap-2 items-center">
            <span>ğŸ“¦</span> ä¸ƒå¤§èª¿å¼ï¼šçµæ§‹ã€ç‰¹æ€§èˆ‡å’Œå¼¦å…¬å¼ç¸½è¦½
        </h2>
        <div>
        <p>èª¿å¼ (Modes) æ˜¯å¾å¤§èª¿éŸ³éšä¸Šçš„ä¸åŒéŸ³ç¬¦é–‹å§‹ï¼Œä»¥ç›¸åŒçš„éŸ³ç¬¦çµ„æˆçš„éŸ³éšã€‚æ¯ç¨®èª¿å¼éƒ½æœ‰å…¶ç¨ç‰¹çš„ç‰¹æ€§éŸ³ç¨‹ï¼Œå¾è€Œç”¢ç”Ÿä¸åŒçš„éŸ³æ¨‚æƒ…æ„Ÿå’Œå’Œè²è‰²å½©ã€‚</p>
        <table class="min-w-full border border-indigo-100 rounded-xl text-center text-sm shadow-sm bg-white mb-4">
        <thead class="bg-indigo-50">
        <tr>
            <th>èª¿å¼åç¨±</th><th>èª¿æ€§åˆ†é¡</th><th>èµ·å§‹éŸ³éšç´šæ•¸</th><th>é—œéµç‰¹æ€§éŸ³ç¨‹</th><th>åŸºç¤ä¸‰å’Œå¼¦ç´šæ•¸ (I - VII)</th><th>è½è¦ºæ„Ÿå—èˆ‡ç”¨é€”</th>
        </tr>
        </thead>
        <tbody>
        <tr><td>Ionian (ä¼Šå¥§å°¼äº)</td><td>å¤§èª¿</td><td>I (1)</td><td>ç„¡ï¼ˆå³å¤§èª¿æœ¬èº«ï¼‰</td><td>M - m - m - M - M - m - dim</td><td>æ˜äº®ã€å¿«æ¨‚ã€ç©©å®šã€‚ä¸»æµæµè¡Œæ¨‚åŸºç¤ã€‚</td></tr>
        <tr><td>Lydian (åˆ©åº•äº)</td><td>å¤§èª¿</td><td>IV (4)</td><td>å‡å››åº¦ (A4)</td><td>M - M - m - dim - M - m - m</td><td>å¤¢å¹»ã€ç©ºéˆã€ç¥è–ã€‚å¸¸ç”¨æ–¼é›»å½±é…æ¨‚ã€‚</td></tr>
        <tr><td>Mixolydian (æ··åˆåˆ©åº•äº)</td><td>å¤§èª¿</td><td>V (5)</td><td>é™ä¸ƒåº¦ (m7)</td><td>M - m - dim - M - m - m - M</td><td>å¸¶æœ‰è—èª¿æ–æ»¾é¢¨æ ¼ã€‚è²éŸ³å¼·å‹ã€æœ‰ã€Œé‡æ€§ã€çš„å±¬éŸ³ã€‚</td></tr>
        <tr><td>Dorian (å¤šåˆ©äº)</td><td>å°èª¿</td><td>ii (2)</td><td>å‡å…­åº¦ (M6)</td><td>m - m - M - M - dim - m - M</td><td>æŸ”å’Œã€è—èª¿æ„Ÿã€çˆµå£«å‘³ã€‚æœ€å¸¸ç”¨çš„å°èª¿å¼ã€‚</td></tr>
        <tr><td>Aeolian (æ„›å¥§åˆ©äº)</td><td>å°èª¿</td><td>vi (6)</td><td>ç„¡ï¼ˆå³è‡ªç„¶å°èª¿æœ¬èº«ï¼‰</td><td>m - dim - M - m - m - M - M</td><td>æ†‚é¬±ã€å…§çœã€æ‚²å‚·ã€‚ä¸»æµå°èª¿éŸ³æ¨‚åŸºç¤ã€‚</td></tr>
        <tr><td>Phrygian (å¼—é‡Œå¹¾äº)</td><td>å°èª¿</td><td>iii (3)</td><td>é™äºŒåº¦ (m2)</td><td>m - M - M - m - dim - M - m</td><td>ç•°åœ‹æƒ…èª¿ã€è¥¿ç­ç‰™æˆ–ä¸­æ±é¢¨æ ¼ã€‚è²éŸ³é»‘æš—ã€‚</td></tr>
        <tr><td>Locrian (æ´›å…‹é‡Œå®‰)</td><td>æ¸›èª¿</td><td>vii (7)</td><td>é™äºŒåº¦ (m2), æ¸›äº”åº¦ (d5)</td><td>dim - M - m - M - m - dim - m</td><td>æ¥µåº¦ä¸ç©©å®šã€è¿´é¿æ€§ã€‚æ¥µå°‘å–®ç¨ç”¨æ–¼å‰µä½œã€‚</td></tr>
        </tbody>
        </table>
        <div class="text-xs text-gray-400">ç¬¦è™Ÿèªªæ˜ï¼šM = å¤§ä¸‰å’Œå¼¦(Major), m = å°ä¸‰å’Œå¼¦(minor), dim = æ¸›ä¸‰å’Œå¼¦(diminished)</div>
        </div>
        `
    };

    // Modalé¡¯ç¤º/é—œé–‰
    function showModal(type) {
        document.getElementById('menu-toggle').checked = false;
        document.getElementById('modal').classList.remove('hidden');
        document.getElementById('modal').classList.add('flex');
        document.getElementById('modal-body').innerHTML = modalContent[type] || '<p>æš«ç„¡å…§å®¹</p>';
    }
    function closeModal(event) {
        // åªå…è¨±é»æ“Šé®ç½©æˆ–å‰å‰é—œé–‰
        if (!event || event.target.id === 'modal' || event.target.id === 'modal-close-outer') {
            document.getElementById('modal').classList.remove('flex');
            document.getElementById('modal').classList.add('hidden');
        }
    }

    // Esc é—œé–‰ Modal
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            document.getElementById('modal').classList.remove('flex');
            document.getElementById('modal').classList.add('hidden');
            document.getElementById('menu-toggle').checked = false;
        }
    });

    // åŸå’Œå¼¦åŠŸèƒ½ï¼ˆä¸è®Šï¼‰
    const NOTES_FOR_PARSING = [
        "C#", "Db", "D#", "Eb", "F#", "Gb", "G#", "Ab", "A#", "Bb", 
        "C", "D", "E", "F", "G", "A", "B"
    ];
    const PITCHES = {
        "C": 0, "C#": 1, "Db": 1, "D": 2, "D#": 3, "Eb": 3, 
        "E": 4, "F": 5, "F#": 6, "Gb": 6, "G": 7, "G#": 8, 
        "Ab": 8, "A": 9, "A#": 10, "Bb": 10, "B": 11
    };
    const OUTPUT_NOTES = ["C", "Db", "D", "Eb", "E", "F", "Gb", "G", "Ab", "A", "Bb", "B"];
    const INTERVAL_NAMES = {
        0: "æ ¹éŸ³ (R)", 1: "å°äºŒåº¦ (b2)", 2: "å¤§äºŒåº¦ (M2)", 3: "å°ä¸‰åº¦ (m3)", 4: "å¤§ä¸‰åº¦ (M3)", 
        5: "å®Œå…¨å››åº¦ (P4)", 6: "æ¸›äº”åº¦ (b5)/å¢å››åº¦ (#4)", 7: "å®Œå…¨äº”åº¦ (P5)", 8: "å¢äº”åº¦ (#5)", 
        9: "å¤§å…­åº¦ (M6)", 10: "å°ä¸ƒåº¦ (m7)", 11: "å¤§ä¸ƒåº¦ (M7)", 12: "å…«åº¦ (8)",
        14: "å¤§ä¹åº¦ (M9)", 15: "å°ååº¦ (m10)", 17: "å®Œå…¨åä¸€åº¦ (P11)", 18: "å¢åä¸€åº¦ (#11)", 
        21: "å¤§åä¸‰åº¦ (M13)"
    };
    const CHORDS = {
        "":        ["å¤§ä¸‰å’Œå¼¦", [4, 7], "ç”±æ ¹éŸ³ã€å¤§ä¸‰åº¦ã€å®Œå…¨äº”åº¦æ§‹æˆã€‚æ˜äº®ã€ç©©å®šã€‚"],
        "m":       ["å°ä¸‰å’Œå¼¦", [3, 7], "ç”±æ ¹éŸ³ã€å°ä¸‰åº¦ã€å®Œå…¨äº”åº¦æ§‹æˆã€‚æŸ”å’Œã€æ†‚é¬±ã€‚"],
        "dim":     ["æ¸›ä¸‰å’Œå¼¦", [3, 6], "ç”±æ ¹éŸ³ã€å°ä¸‰åº¦ã€æ¸›äº”åº¦æ§‹æˆã€‚æ¥µåº¦ä¸ç©©å®šã€‚"],
        "aug":     ["å¢ä¸‰å’Œå¼¦", [4, 8], "ç”±æ ¹éŸ³ã€å¤§ä¸‰åº¦ã€å¢äº”åº¦æ§‹æˆã€‚ä¸ç©©å®šã€æœ‰æ“´å¼µæ„Ÿã€‚"],
        "sus4":    ["æ›ç•™å››å’Œå¼¦", [5, 7], "å››åº¦å–ä»£ä¸‰åº¦ã€‚ä¸ç©©å®šï¼Œå‚¾å‘è§£æ±ºåˆ°å¤§ä¸‰æˆ–å°ä¸‰å’Œå¼¦ã€‚"],
        "sus2":    ["æ›ç•™äºŒå’Œå¼¦", [2, 7], "äºŒåº¦å–ä»£ä¸‰åº¦ã€‚æ¸…æ–°ã€é–‹æ”¾çš„éŸ³éŸ¿ã€‚"],
        "add9":    ["åŠ ä¹å’Œå¼¦", [4, 7, 14], "å¤§ä¸‰å’Œå¼¦åŠ ä¸Šå¤§ä¹åº¦ï¼ˆæ²’æœ‰ä¸ƒåº¦éŸ³ï¼‰ã€‚æ¯”å–®ç´”å¤§ä¸‰æ›´æŸ”å’Œã€‚"],
        "madd9":   ["å°èª¿åŠ ä¹å’Œå¼¦", [3, 7, 14], "å°ä¸‰å’Œå¼¦åŠ ä¸Šå¤§ä¹åº¦ï¼ˆæ²’æœ‰ä¸ƒåº¦éŸ³ï¼‰ã€‚"],
        "7":       ["å±¬ä¸ƒå’Œå¼¦", [4, 7, 10], "å¤§ä¸‰å’Œå¼¦åŠ ä¸Šå°ä¸ƒåº¦ã€‚å…·æœ‰å¼·çƒˆå‚¾å‘è§£æ±ºçš„å±¬åŠŸèƒ½ã€‚"],
        "maj7":    ["å¤§ä¸ƒå’Œå¼¦", [4, 7, 11], "å¤§ä¸‰å’Œå¼¦åŠ ä¸Šå¤§ä¸ƒåº¦ã€‚æŸ”å’Œã€å¯¬å»£ã€å¸¶æœ‰çˆµå£«è‰²å½©ã€‚"],
        "m7":      ["å°ä¸ƒå’Œå¼¦", [3, 7, 10], "å°ä¸‰å’Œå¼¦åŠ ä¸Šå°ä¸ƒåº¦ã€‚å…§æ–‚ã€è±å¯Œã€å¸¸ç”¨æ–¼çˆµå£«å’Œæµè¡Œã€‚"],
        "mmaj7":   ["å°å¤§ä¸ƒå’Œå¼¦", [3, 7, 11], "å°ä¸‰å’Œå¼¦åŠ ä¸Šå¤§ä¸ƒåº¦ã€‚è‰²å½©ç¨ç‰¹ï¼Œå¸¸ç‡Ÿé€ ç¥ç§˜æˆ–ç·Šå¼µæ„Ÿã€‚"],
        "m7b5":    ["åŠæ¸›ä¸ƒå’Œå¼¦", [3, 6, 10], "ç”±æ¸›ä¸‰å’Œå¼¦åŠ ä¸Šå°ä¸ƒåº¦æ§‹æˆã€‚å¸¸ä½œç‚ºå°èª¿çš„äºŒç´šå’Œå¼¦ã€‚"],
        "dim7":    ["æ¸›ä¸ƒå’Œå¼¦", [3, 6, 9], "ç”±æ¸›ä¸‰å’Œå¼¦åŠ ä¸Šæ¸›ä¸ƒåº¦ï¼ˆé›™é™ä¸ƒåº¦ï¼‰ã€‚é«˜åº¦å°ç¨±ï¼Œæ¥µä¸ç©©å®šï¼Œå¸¸ä½œè½‰èª¿ç”¨ã€‚"],
        "7#5":     ["å¢å±¬ä¸ƒå’Œå¼¦", [4, 8, 10], "å±¬ä¸ƒå’Œå¼¦çš„äº”åº¦éŸ³å‡é«˜åŠéŸ³ã€‚"],
        "7b5":     ["æ¸›äº”å±¬ä¸ƒå’Œå¼¦", [4, 6, 10], "å±¬ä¸ƒå’Œå¼¦çš„äº”åº¦éŸ³é™ä½åŠéŸ³ã€‚"],
        "7#9":     ["å±¬ä¸ƒå‡ä¹å’Œå¼¦", [4, 7, 10, 15], "å±¬ä¸ƒå’Œå¼¦åŠ ä¸Šå¢ä¹åº¦ (å°ä¸‰åº¦)ã€‚å¼·çƒˆçš„å±¬åŠŸèƒ½ã€‚"],
        "7b9":     ["å±¬ä¸ƒé™ä¹å’Œå¼¦", [4, 7, 10, 13], "å±¬ä¸ƒå’Œå¼¦åŠ ä¸Šå°ä¹åº¦ã€‚å¼·çƒˆçš„è§£æ±ºè¶¨å‹¢ã€‚"],
        "9":       ["å±¬ä¹å’Œå¼¦", [4, 7, 10, 14], "å±¬ä¸ƒå’Œå¼¦åŠ ä¸Šå¤§ä¹åº¦ã€‚é£½æ»¿ã€çˆµå£«å‘³æ¿ƒåšã€‚"],
        "m9":      ["å°ä¹å’Œå¼¦", [3, 7, 10, 14], "å°ä¸ƒå’Œå¼¦åŠ ä¸Šå¤§ä¹åº¦ã€‚æ·±æ²‰ã€è±å¯Œã€å¸¸ç‡Ÿé€ å†·éœæ°›åœã€‚"],
        "maj9":    ["å¤§ä¹å’Œå¼¦", [4, 7, 11, 14], "å¤§ä¸ƒå’Œå¼¦åŠ ä¸Šå¤§ä¹åº¦ã€‚æ¥µå…¶æŸ”å’Œã€é«˜é›…çš„çˆµå£«è‰²å½©ã€‚"],
        "11":      ["å±¬åä¸€å’Œå¼¦", [4, 7, 10, 14, 17], "å±¬ä¹å’Œå¼¦åŠ ä¸Šå®Œå…¨åä¸€åº¦ã€‚é€šå¸¸çœç•¥ä¸‰åº¦éŸ³ã€‚"],
        "m11":     ["å°åä¸€å’Œå¼¦", [3, 7, 10, 14, 17], "å°ä¹å’Œå¼¦åŠ ä¸Šå®Œå…¨åä¸€åº¦ã€‚å¸¸ç”¨æ–¼çˆµå£«æ¨‚çš„äºŒç´šå’Œå¼¦ã€‚"],
        "maj11":   ["å¤§åä¸€å’Œå¼¦", [4, 7, 11, 14, 17], "å¤§ä¹å’Œå¼¦åŠ ä¸Šå®Œå…¨åä¸€åº¦ã€‚è¼ƒå°‘è¦‹ã€‚"],
        "#11":     ["å±¬ä¸ƒå‡åä¸€å’Œå¼¦", [4, 7, 10, 14, 18], "å±¬ä¹å’Œå¼¦åŠ ä¸Šå¢åä¸€åº¦ã€‚å¸¶æœ‰Lydianè‰²å½©ã€‚"],
        "maj#11":  ["å¤§ä¸ƒå‡åä¸€å’Œå¼¦", [4, 7, 11, 14, 18], "å¤§ä¹å’Œå¼¦åŠ ä¸Šå¢åä¸€åº¦ã€‚å…¸å‹çš„Lydianå’Œå¼¦ï¼Œæ˜äº®è€Œå¤¢å¹»ã€‚"],
        "13":      ["å±¬åä¸‰å’Œå¼¦", [4, 7, 10, 14, 17, 21], "å±¬åä¸€å’Œå¼¦åŠ ä¸Šå¤§åä¸‰åº¦ã€‚æœ€è±æ»¿çš„å±¬åŠŸèƒ½å’Œå¼¦ã€‚"],
        "m13":     ["å°åä¸‰å’Œå¼¦", [3, 7, 10, 14, 17, 21], "å°åä¸€å’Œå¼¦åŠ ä¸Šå¤§åä¸‰åº¦ã€‚æº«æš–è€Œæ·±é‚ƒçš„çˆµå£«è‰²å½©ã€‚"],
        "maj13":   ["å¤§åä¸‰å’Œå¼¦", [4, 7, 11, 14, 17, 21], "å¤§åä¸€å’Œå¼¦åŠ ä¸Šå¤§åä¸‰åº¦ã€‚æ¥µå…¶è±å¯Œã€å¹³éœçš„å’Œå¼¦ã€‚"],
    };

    function getNoteName(index) { return OUTPUT_NOTES[index % 12]; }
    function getChordTonesAndIntervals(rootName, intervals) {
        const rootIndex = PITCHES[rootName];
        if (rootIndex === undefined) return { tones: [], intervals: [] };

        const tones = [rootName];
        const intervalNames = [INTERVAL_NAMES[0]];

        for (const interval of intervals) {
            const toneIndex = (rootIndex + interval) % 12;
            const noteName = getNoteName(toneIndex);
            tones.push(noteName);
            intervalNames.push(INTERVAL_NAMES[interval] || `æœªçŸ¥ (${interval} åŠéŸ³)`);
        }
        return { tones, intervals: intervalNames };
    }
    function parseChordInput(input) {
        const upperInput = input.toUpperCase().replace(/\s/g, '');
        for (const note of NOTES_FOR_PARSING) {
            if (upperInput.startsWith(note)) {
                const rootName = note;
                let quality = upperInput.substring(note.length).toLowerCase();
                quality = quality.replace(/\(maj7\)/, 'maj7');
                quality = quality.replace(/(-5|\(b5\))/, 'b5');
                if (quality.startsWith('add')) quality = 'add' + quality.substring(3);
                if (quality.startsWith('sus')) quality = 'sus' + quality.substring(3);
                if (quality === "#5") quality = "aug"; 
                if (quality === "b5") quality = "dim"; 
                return { rootName, quality };
            }
        }
        return null;
    }
    function translateChord() {
        const input = document.getElementById('chordInput').value.trim();
        const resultDiv = document.getElementById('result');
        resultDiv.className = "mt-8 p-5 bg-white border border-indigo-100 rounded-xl text-gray-800 shadow-md transition duration-300";
        if (!input) {
            resultDiv.innerHTML = "<p class='text-center text-lg text-gray-500'>è«‹è¼¸å…¥ä¸€å€‹æœ‰æ•ˆçš„å’Œå¼¦åç¨±ï¼</p>";
            return;
        }
        let parsed = parseChordInput(input);
        if (!parsed) {
             const singleRoot = input.toUpperCase();
             if (PITCHES.hasOwnProperty(singleRoot) && singleRoot.length <= 2) {
                 parsed = { rootName: singleRoot, quality: "" };
             } else {
                 resultDiv.innerHTML = `<p class='text-center text-lg text-red-500 font-semibold'>ç„¡æ³•è­˜åˆ¥çš„æ ¹éŸ³ï¼š<strong>${input}</strong></p><p class='text-center text-gray-500'>è«‹ä½¿ç”¨æ¨™æº–éŸ³å C, D, Eb, F#, Bb, ç­‰ã€‚</p>`;
                 return;
             }
        }
        const { rootName, quality } = parsed;
        const chordInfo = CHORDS[quality];
        if (!chordInfo) {
            resultDiv.innerHTML = `<p class='text-center text-lg text-red-500 font-semibold'>ç„¡æ³•è­˜åˆ¥çš„å’Œå¼¦é¡å‹ï¼š<strong>${quality || "ï¼ˆå¤§ä¸‰å’Œå¼¦é™¤å¤–ï¼‰"}</strong></p><p class='text-center text-gray-500'>è«‹ç¢ºèªè¼¸å…¥çš„å’Œå¼¦è¨˜è™Ÿæ˜¯å¦æ¨™æº–ã€‚</p>`;
            return;
        }
        const [chordName, intervals, definition] = chordInfo;
        const { tones, intervals: intervalNames } = getChordTonesAndIntervals(rootName, intervals);
        if (tones.length === 0) {
             resultDiv.innerHTML = `<p class='text-center text-lg text-red-500'>å…§éƒ¨éŒ¯èª¤ï¼šç„¡æ³•è¨ˆç®—å’Œå¼¦éŸ³ã€‚</p>`;
             return;
        }
        let output = `
<div class="space-y-6">
    <p class="text-2xl font-extrabold text-indigo-700 text-center tracking-wide">
        ${rootName}${quality} 
        <span class="block text-base font-medium text-gray-500 mt-1">(${rootName}${chordName})</span>
    </p>
    <div class="bg-gradient-to-r from-indigo-50 via-white to-indigo-100 p-4 rounded-xl border border-indigo-50 shadow">
        <p class="text-xl font-bold text-gray-800 mb-2 border-b border-indigo-100 pb-1">ğŸµ çµ„æˆéŸ³:</p>
        <p class="text-4xl font-mono tracking-wider text-red-600 text-center">${tones.join(' - ')}</p>
    </div>
    <div class="p-4 rounded-xl border border-indigo-100 bg-white shadow">
        <p class="text-xl font-bold text-gray-800 mb-3 border-b border-indigo-100 pb-1">ğŸ¶ éŸ³ç¨‹é—œä¿‚:</p>
        <div class="grid grid-cols-2 gap-3 text-sm sm:text-base">
            ${tones.map((tone, index) => 
                `<p class="flex items-center"><span class="font-mono bg-indigo-100 text-indigo-700 px-2 py-1 rounded mr-2 w-12 text-center">${tone}</span> <span class="text-gray-600">${intervalNames[index]}</span></p>`
            ).join('')}
        </div>
    </div>
    <p class="text-base pt-2 border-t border-indigo-100">
        <span class="font-bold text-indigo-700">âœ¨ å®šç¾©èˆ‡ç‰¹æ€§ï¼š</span> ${definition}
    </p>
</div>
        `;
        resultDiv.innerHTML = output;
    }
</script>
</body>
</html>
