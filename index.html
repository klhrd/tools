<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">

    <link rel="shortcut icon" href="../assets/favicon.ico" type="image/x-icon">
    <link rel="icon" href="../assets/favicon.png" type="image/png">

    <title>正在偵測最新版本...</title>
</head>
<body>
    <div id="status">正在自動尋找最新版本，請稍候...</div>

    <script>
        // === 請修改以下資訊 ===
        const USER = 'klhrd';          // 你的 GitHub 帳號
        const REPO = 'tools';          // 你的 Repository 名稱
        const FOLDER = 'home';         // 存放版本的資料夾
        // =====================

        async function redirectToLatest() {
            const statusDiv = document.getElementById('status');
            try {
                // 1. 呼叫 GitHub API 取得資料夾檔案內容
                const response = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${FOLDER}`);
                
                if (!response.ok) throw new Error('無法取得檔案列表');

                const files = await response.json();

                // 2. 過濾出所有 .html 檔案，並排除 index.html
                const htmlFiles = files
                    .filter(file => file.name.endsWith('.html') && file.name !== 'index.html')
                    .map(file => file.name);

                if (htmlFiles.length > 0) {
                    // 3. 排序 (v2.1, v2.2...) 並取得最後一個
                    const latest = htmlFiles.sort().pop();
                    
                    // 4. 跳轉至該檔案
                    window.location.replace(`${FOLDER}/${latest}`);
                } else {
                    statusDiv.innerText = "資料夾內找不到任何 HTML 版本檔案。";
                }

            } catch (error) {
                console.error(error);
                statusDiv.innerHTML = `發生錯誤，請檢查網路或專案設定。<br>或是手動前往：<a href="${FOLDER}/v2.2.html">v2.2.html</a>`;
            }
        }

        redirectToLatest();
    </script>
</body>
</html>